<%- include('../partials/head', { title: 'Главная' }) %>
  <body class="bg-dark font-raleway">
    <main class="content">

      <h1 class="hidden text-white">SOME BY MI</h1>

      <!-- Главная страница -->
      <section class="main bg-white text-black">
        <div class="flex flex-col lg:flex-row max-w-[1440px] w-full mx-auto">

          <!-- Левая часть: изображение -->
          <div class="w-[710px] bg-mud">
            <img src="/images/main-illustration.png" alt="main-illustration" class="w-[710px] h-[934px] object-cover" />
          </div>

          <!-- Правая часть: контент -->
          <div class="w-[730px] pl-[73px] pr-[76px] pb-[50px]">

            <!-- Header -->
            <header>
              <nav class="hidden lg:flex justify-between items-center my-[50px] text-lg text-black font-light uppercase">
                <div class="flex flex-wrap gap-[clamp(15px,2.5vw,35px)]">
                  <a href="/products" class="hover:text-dark">Каталог</a>
                  <a href="/skincare" class="hover:text-dark">Skincare</a>
                  <a href="/about" class="hover:text-dark">О нас</a>
                </div>
                <div class="flex-1"></div>
                <div class="flex gap-[clamp(10px,2vw,20px)]">
                  <% if (typeof customer !== 'undefined') { %>
                    <a href="/account" class="hover:text-dark">
                      <span><%= customer.username %></span>
                    </a>
                  <% } else { %>
                    <button id="authPopupBtn" class="auth-btn hover:text-darkgreen" style="text-transform:uppercase; text-decoration: underline;">Профиль</button>
                  <% } %>
                  <a href="/cart" class="hover:text-dark">Корзина</a>
                </div>
              </nav>
              <%- include('../partials/auth-popup') %>
            </header>

            <!-- Картинки -->
            <div class="flex justify-between">
              <img src="/images/product.png" alt="main-product" class="w-[270px] h-[270px] object-cover" />
              <img src="/images/haerin.png" alt="main-haerin" class="w-[270px] h-[408px] object-cover self-start" />
            </div>

            <!-- Заголовок -->
            <p class="text-2xl font-medium text-left text-5xl mt-[20px] uppercase">Take care of yourself</p>

            <!-- Текст в двух колонках -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-[41px] text-lg font-light leading-snug text-black leading-relaxed mt-[30px]">
              <p>
                Great skin is not simply a matter of DNA — your daily habits, in fact,
                have a big impact on what you see in the mirror. But depending on which
                product reviews you read or doctors you consult, there is a dizzying
                number of opinions.
              </p>
              <p>
                On everything from how to moisturize to how to protect yourself from UV rays.
                Ultimately, caring for your skin is simply personal. Here’s what you should
                keep in mind to sort through all the noise.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Бестселлеры -->
      <section class="bestsellers bg-mud text-white">
        <div class="relative overflow-hidden max-w-[1440px] min-w-[1440px] pt-[60px] pb-[80px] mx-auto">
          <h2 class="text-4xl font-medium mb-[60px] ml-[78px] uppercase">Бестселлеры</h2>

          <!-- Карусель -->
          <div class="relative px-[157px]">

            <!-- Стрелка влево -->
            <button id="prevBtn" class="absolute left-[55px] top-1/2 -translate-y-1/2 z-10 disabled:opacity-50 disabled:pointer-events-none">
              <img src="/svgs/left-arrow.svg" alt="Prev">
            </button>

            <!-- Оверфлоу контейнер -->
            <div class="relative overflow-hidden">
              <!-- Контейнер с карточками -->
              <div id="carousel" class="flex transition-transform duration-500 ease-in-out gap-[100px]">

                <% bestsellers.forEach((product, index) => { %>
                <div class="min-w-[308px] max-w-[308px] flex-shrink-0 flex flex-col uppercase">
                  <a href="/products/<%= product.id %>">
                    <img src="<%= product.image_url %>" alt="<%= product.name %>" class="w-[308px] h-[419px] object-cover">
                  </a>
                  <a href="/products/<%= product.id %>" class="pt-[30px] flex flex-col items-start gap-[15px] leading-tight hover:text-hoverw">
                    <h3 class="text-2xl font-medium"><%= product.name %></h3>
                    <p class="text-xl font-light"><%= product.type %></p>
                  </a>
                  <div class="mt-[20px] flex justify-between items-center">
                    <span class="font-quicksand font-medium text-xl"><%= product.price %> ₽</span>
                    <form action="/cart/add" style="height: 32px;" method="POST">
                      <input type="hidden" name="productId" value="<%= product.id %>">
                      <button type="submit" class="relative group">
                        <img src="/svgs/plus-white.svg" alt="Добавить" class="w-8 h-8 group-hover:hidden" />
                        <img src="/svgs/plus-white-press.svg" alt="Добавить" class="w-8 h-8 hidden group-hover:block" />
                      </button>
                    </form>
                  </div>
                </div>
                <% }); %>

              </div>
            </div>

            <!-- Стрелка вправо -->
            <button id="nextBtn" class="absolute right-[55px] top-1/2 -translate-y-1/2 z-10 disabled:opacity-50 disabled:pointer-events-none">
              <img src="/svgs/right-arrow.svg" alt="Next">
            </button>
          </div>

          <!-- Точки навигации -->
          <div class="flex justify-center gap-2 mt-[53px]" id="carousel-dots">
            <% bestsellers.slice(0, bestsellers.length - 2).forEach((_, i) => { %>
            <svg class="w-3 h-3 cursor-pointer" fill="<%= i === 0 ? '#DADED6' : '#52544E' %>" viewBox="0 0 8 8">
              <circle cx="4" cy="4" r="3" stroke="#DADED6" stroke-width="1" />
            </svg>
            <% }); %>
          </div>
        </div>
        <script src="/js/carousel.js" defer></script>
      </section>


      <!-- Каталог товаров -->
      <section class="product-list bg-white text-black">
        <div class="relative max-w-[1440px] min-w-[1440px] pt-[50px] pb-[80px] mx-auto">

          <!-- Фильтры -->
          <div class="filters-line px-[75px] font-light text-sm flex flex-row gap-[63px] relative">

            <!-- Кнопка фильтра категорий (закрытое состояние) -->
            <div class="relative">
              <button id="categoryFilterBtn" class="gap-[15px] h-[45px] px-[22px] py-[17px] flex flex-row justify-between items-center border border-solid rounded-[3px] w-full">
                <p>Категории</p>
                <img src="/svgs/dropdown.svg" class="w-[16px] h-[7px]">
              </button>
              <div id="categoryOpenFilter" class="absolute left-0 top-full mt-1 border border-solid rounded-[3px] w-[143px] h-[277px] bg-white z-10 hidden">
                <button class="h-[45px] pt-[17px] pb-[15px] px-[22px] flex items-center w-full">
                  <p class="hover:text-hoverb">Все</p>
                </button>
                <div class="h-[1px] w-full bg-black opacity-[.36]"></div>
                <button class="h-[45px] pt-[17px] pb-[15px] px-[22px] flex items-center w-full">
                  <p class="hover:text-hoverb">Anti-aging</p>
                </button>
                <div class="h-[1px] w-full bg-black opacity-[.36]"></div>
                <button class="h-[45px] pt-[17px] pb-[15px] px-[22px] flex items-center w-full">
                  <p class="hover:text-hoverb">Watering</p>
                </button>
                <div class="h-[1px] w-full bg-black opacity-[.36]"></div>
                <button class="h-[45px] pt-[17px] pb-[15px] px-[22px] flex items-center w-full">
                  <p class="hover:text-hoverb">Cleaning</p>
                </button>
                <div class="h-[1px] w-full bg-black opacity-[.36]"></div>
                <button class="h-[45px] pt-[17px] pb-[15px] px-[22px] flex items-center w-full">
                  <p class="hover:text-hoverb">Calming</p>
                </button>
                <div class="h-[1px] w-full bg-black opacity-[.36]"></div>
                <button class="h-[45px] pt-[17px] pb-[15px] px-[22px] flex items-center w-full">
                  <p class="hover:text-hoverb">Problem skin</p>
                </button>
              </div>
            </div>

            <!-- Кнопка фильтра сортировки (закрытое состояние) -->
            <div class="relative">
              <button id="sortFilterBtn" class="gap-[15px] h-[45px] px-[22px] py-[17px] flex flex-row justify-between items-center border border-solid rounded-[3px] w-full">
                <p>Сортировать</p>
                <img src="/svgs/dropdown.svg" class="w-[16px] h-[7px]">
              </button>
              <div id="sortOpenFilter" class="absolute left-0 top-full mt-1 border border-solid rounded-[3px] w-[160px] h-[95px] bg-white z-10 hidden">
                <button class="h-[45px] pt-[17px] pb-[15px] px-[22px] flex items-center w-full">
                  <p class="text-left hover:text-hoverb">Цена: по возрастанию</p>
                </button>
                <div class="h-[1px] w-full bg-black opacity-[.36]"></div>
                <button class="h-[45px] pt-[17px] pb-[15px] px-[22px] flex items-center w-full">
                  <p class="text-left hover:text-hoverb">Цена: по убыванию</p>
                </button>
              </div>
            </div>

          </div>

          <!-- Каталог товаров c пагинацией -->
          <div class="relative pt-[50px] px-[75px] flex flex-col">
            <% products.forEach((product, index) => { %>
            <div class="product-item min-w-[256px] max-w-[256px] flex-shrink-0 flex flex-col uppercase">
              <a href="/products/<%= product.id %>">
                <img src="<%= product.image_url %>" alt="<%= product.name %>" class="w-[256px] h-[347px] object-cover">
              </a>
              <a href="/products/<%= product.id %>" class="pt-[30px] flex flex-col items-start gap-[15px] leading-tight hover:text-hoverb">
                <h3 class="text-2xl font-medium"><%= product.name %></h3>
                <p class="text-xl font-light"><%= product.type %></p>
              </a>
              <div class="mt-[20px] flex justify-between items-center">
                <span class="hidden"><%= product.category %></span>
                <span class="font-quicksand font-medium text-xl"><%= product.price %> ₽</span>
                <form action="/cart/add" style="height: 32px;" method="POST">
                  <input type="hidden" name="productId" value="<%= product.id %>">
                  <button type="submit" class="relative group">
                    <img src="/svgs/plus-black.svg" alt="Добавить" class="w-8 h-8 group-hover:hidden" />
                    <img src="/svgs/plus-black-press.svg" alt="Добавить" class="w-8 h-8 hidden group-hover:block" />
                  </button>
                </form>
              </div>
            </div>
            <% }); %>
          </div>
        <script src="/js/pagination.js" defer></script>
        <script src="/js/filter.js" defer></script>
      </section>
    </main>
<%- include('../partials/footer') %>
